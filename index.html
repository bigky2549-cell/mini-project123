<!DOCTYPE html>
<html lang="th">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Smart Home Dashboard</title>
Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
Â  Â  <style>
Â  Â  Â  Â  @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;500&display=swap');
Â  Â  Â  Â  body { font-family: 'Kanit', sans-serif; background-color: #0f172a; color: #f8fafc; display: flex; flex-direction: column; align-items: center; padding: 20px; }
Â  Â  Â  Â  .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; width: 100%; max-width: 1000px; }
Â  Â  Â  Â  .card { background: #1e293b; padding: 25px; border-radius: 20px; text-align: center; border: 1px solid #334155; }
Â  Â  Â  Â  .value { font-size: 3rem; font-weight: bold; color: #38bdf8; }
Â  Â  Â  Â  .btn-group { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
Â  Â  Â  Â  button { padding: 12px 30px; border-radius: 12px; border: none; font-size: 1rem; cursor: pointer; transition: 0.3s; font-family: 'Kanit', sans-serif; }
Â  Â  Â  Â  .btn-on { background-color: #22c55e; color: white; }
Â  Â  Â  Â  .btn-off { background-color: #ef4444; color: white; }
Â  Â  Â  Â  .btn-on:hover { background-color: #16a34a; }
Â  Â  Â  Â  .btn-off:hover { background-color: #dc2626; }
Â  Â  Â  Â  .status-box { margin-top: 10px; font-size: 0.9rem; padding: 5px 10px; border-radius: 5px; background: #334155; display: inline-block; }
Â  Â  Â  Â  .warning { background-color: #ef4444 !important; color: white; font-weight: bold; animation: blink 1s infinite; }
Â  Â  Â  Â  @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
Â  Â  </style>
</head>
<body>

Â  Â  <h1>ğŸ  à¸£à¸°à¸šà¸šà¸„à¸§à¸šà¸„à¸¸à¸¡à¸šà¹‰à¸²à¸™ mini project</h1>

Â  Â  <div class="dashboard">
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div>ğŸŒ¡ï¸ à¸­à¸¸à¸“à¸«à¸ à¸¹à¸¡à¸´à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸Šà¸·à¹‰à¸™</div>
Â  Â  Â  Â  Â  Â  <div class="value"><span id="temp">--</span>Â°C</div>
Â  Â  Â  Â  Â  Â  <div>à¸„à¸§à¸²à¸¡à¸Šà¸·à¹‰à¸™: <span id="humi">--</span>%</div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div>â˜€ï¸ à¹à¸ªà¸‡à¸ªà¸§à¹ˆà¸²à¸‡ (LDR)</div>
Â  Â  Â  Â  Â  Â  <div class="value" id="light_val">--</div>
Â  Â  Â  Â  Â  Â  <div id="light_status" class="status-box">à¸£à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥...</div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div>ğŸ’¨ à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¸„à¸§à¸±à¸™/à¹à¸à¹Šà¸ª (MQ)</div>
Â  Â  Â  Â  Â  Â  <div class="value" id="gas_val">--</div>
Â  Â  Â  Â  Â  Â  <div id="gas_status" class="status-box">à¸ªà¸–à¸²à¸™à¸°: à¸›à¸à¸•à¸´</div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div>ğŸ’¡ à¸«à¸¥à¸­à¸”à¹„à¸Ÿ (Relay 1)</div>
Â  Â  Â  Â  Â  Â  <div class="status-box">à¸ªà¸–à¸²à¸™à¸°: <b id="st-light">--</b></div>
Â  Â  Â  Â  Â  Â  <div class="btn-group">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-on" onclick="send('light', 'ON')">à¹€à¸›à¸´à¸”</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-off" onclick="send('light', 'OFF')">à¸›à¸´à¸”</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div>ğŸŒ€ à¸à¸±à¸”à¸¥à¸¡ (Relay 2)</div>
Â  Â  Â  Â  Â  Â  <div class="status-box">à¸ªà¸–à¸²à¸™à¸°: <b id="st-fan">--</b></div>
Â  Â  Â  Â  Â  Â  <div class="btn-group">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-on" onclick="send('fan', 'ON')">à¹€à¸›à¸´à¸”</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-off" onclick="send('fan', 'OFF')">à¸›à¸´à¸”</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div>â„ï¸ à¹à¸­à¸£à¹Œà¸ˆà¸³à¸¥à¸­à¸‡ (Relay 3)</div>
Â  Â  Â  Â  Â  Â  <div class="status-box">à¸ªà¸–à¸²à¸™à¸°: <b id="st-ac">--</b></div>
Â  Â  Â  Â  Â  Â  <div class="btn-group">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-on" onclick="send('ac', 'ON')">à¹€à¸›à¸´à¸”</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-off" onclick="send('ac', 'OFF')">à¸›à¸´à¸”</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // *** à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² Config à¸™à¸µà¹‰à¸•à¸£à¸‡à¸à¸±à¸šà¹ƒà¸™à¸šà¸­à¸£à¹Œà¸” NodeMCU ***
Â  Â  Â  Â  const firebaseConfig = {
Â  Â  Â  Â  Â  Â  apiKey: "AIzaSyDVK0e02FBue3EW0e7JqbCKPe6YE7zREqE",
Â  Â  Â  Â  Â  Â  authDomain: "mini-project-2fa5e.firebaseapp.com",
Â  Â  Â  Â  Â  Â  databaseURL: "https://mini-project-2fa5e-default-rtdb.asia-southeast1.firebasedatabase.app/",
Â  Â  Â  Â  Â  Â  projectId: "mini-project-2fa5e",
Â  Â  Â  Â  Â  Â  storageBucket: "mini-project-2fa5e.appspot.com",
Â  Â  Â  Â  Â  Â  messagingSenderId: "336990756770",
Â  Â  Â  Â  Â  Â  appId: "1:336990756770:web:73753e5604463516879cfb"
Â  Â  Â  Â  };

Â  Â  Â  Â  firebase.initializeApp(firebaseConfig);
Â  Â  Â  Â  const db = firebase.database();

Â  Â  Â  Â  // 1. à¸”à¸¶à¸‡à¸„à¹ˆà¸²à¹€à¸‹à¸™à¹€à¸‹à¸­à¸£à¹Œà¸ˆà¸²à¸ Path "room"
Â  Â  Â  Â  db.ref("room").on("value", (snapshot) => {
Â  Â  Â  Â  Â  Â  const data = snapshot.val();
Â  Â  Â  Â  Â  Â  if (data) {
Â  Â  Â  Â  Â  Â  Â  Â  // à¸­à¸±à¸›à¹€à¸”à¸•à¸•à¸±à¸§à¹€à¸¥à¸‚
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("temp").innerText = data.temp !== undefined ? data.temp : "--";
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("humi").innerText = data.humi !== undefined ? data.humi : "--";
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("light_val").innerText = data.light !== undefined ? data.light : "--";
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("gas_val").innerText = data.gas !== undefined ? data.gas : "--";

Â  Â  Â  Â  Â  Â  Â  Â  // à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸ªà¸–à¸²à¸™à¸°à¹à¸ªà¸‡ (LDR)
Â  Â  Â  Â  Â  Â  Â  Â  const lStatus = document.getElementById("light_status");
Â  Â  Â  Â  Â  Â  Â  Â  if (data.light < 500) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lStatus.innerText = "à¸ªà¸–à¸²à¸™à¸°: à¸¡à¸·à¸” (à¹€à¸›à¸´à¸”à¹„à¸Ÿà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹„à¸”à¹‰)";
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lStatus.innerText = "à¸ªà¸–à¸²à¸™à¸°: à¸ªà¸§à¹ˆà¸²à¸‡";
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸ªà¸–à¸²à¸™à¸°à¹à¸à¹Šà¸ª
Â  Â  Â  Â  Â  Â  Â  Â  const gStatus = document.getElementById("gas_status");
Â  Â  Â  Â  Â  Â  Â  Â  // à¸–à¹‰à¸²à¸„à¹ˆà¸²à¸¡à¸²à¸à¸à¸§à¹ˆà¸² 400 à¸«à¸£à¸·à¸­à¸–à¹‰à¸²à¹€à¸›à¹‡à¸™ Digital Sensor à¸„à¹ˆà¸² 1 à¸„à¸·à¸­à¸•à¸£à¸§à¸ˆà¹€à¸ˆà¸­
Â  Â  Â  Â  Â  Â  Â  Â  if (data.gas > 400 || data.gas == 1) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gStatus.innerText = "âš ï¸ à¸•à¸£à¸§à¸ˆà¸à¸šà¸„à¸§à¸±à¸™/à¹à¸à¹Šà¸ª!";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gStatus.className = "status-box warning";
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gStatus.innerText = "à¸ªà¸–à¸²à¸™à¸°: à¸›à¸à¸•à¸´";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gStatus.className = "status-box";
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, (error) => {
Â  Â  Â  Â  Â  Â  console.error("Firebase Error: ", error);
Â  Â  Â  Â  });

Â  Â  Â  Â  // 2. à¸”à¸¶à¸‡à¸ªà¸–à¸²à¸™à¸°à¸›à¸¸à¹ˆà¸¡à¸ˆà¸²à¸ Path "control"
Â  Â  Â  Â  db.ref("control").on("value", (snapshot) => {
Â  Â  Â  Â  Â  Â  const data = snapshot.val();
Â  Â  Â  Â  Â  Â  if (data) {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("st-light").innerText = data.light || "OFF";
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("st-fan").innerText = data.fan || "OFF";
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("st-ac").innerText = data.ac || "OFF";
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // 3. à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸ªà¹ˆà¸‡à¸„à¹ˆà¸²à¸à¸¥à¸±à¸šà¹„à¸›à¸—à¸µà¹ˆ Firebase
Â  Â  Â  Â  function send(path, cmd) {
Â  Â  Â  Â  Â  Â  db.ref("control/" + path).set(cmd)
Â  Â  Â  Â  Â  Â  Â  Â  .then(() => console.log("Sent " + cmd + " to " + path))
Â  Â  Â  Â  Â  Â  Â  Â  .catch((err) => alert("à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: " + err.message));
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>         à¸—à¸³à¹ƒà¸«à¹‰à¸•à¸£à¸‡à¸à¸±à¸™à¹à¸¥à¹‰à¸§à¸‚à¸­à¸«à¸™à¹‰à¸²à¹€à¸§à¹‡à¸›à¹à¸šà¸šà¸¥à¹‰à¸³à¹†
